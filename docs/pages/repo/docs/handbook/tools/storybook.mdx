import { Tabs, Tab } from '../../../../../components/Tabs'
import Callout from '../../../../../components/Callout'

# Using Storybook with Turborepo

[Storybook](https://storybook.js.org/) is a popular way to build UI components in an isolated environment. By putting Storybook into your Turborepo, you can easily develop your design system right alongside your applications.

## Guide

This guide shows you how to:

1. Set up Storybook in a monorepo
2. Create your first story
3. Ensure Storybook works with the rest of your tasks

### 1. Create your Monorepo

If you don't have an existing project, use our [quickstart](/repo/docs/getting-started/create-new) to create a new monorepo.

### 2. Add a new `workshop` app

Storybook needs a builder to use so we will create a Vite app.

<Tabs items={["npm", "yarn", "pnpm"]} storageKey="selected-pkg-manager">
  <Tab>
    ```shell
    cd apps
    npm create vite
    ```
  </Tab>
  <Tab>
    ```shell
    cd apps
    yarn create vite
    ```
  </Tab>
  <Tab>
    ```shell
    cd apps
    pnpm create vite
    ```
  </Tab>
</Tabs>

Follow the prompts to create an app named "workshop" as a React, TypeScript app.

Next, we need to scaffold Storybook:

<Tabs items={["npm", "yarn", "pnpm"]} storageKey="selected-pkg-manager">
  <Tab>
    ```shell
    cd workshop
    npx sb init --builder @storybook/builder-vite
    ```
  </Tab>
  <Tab>
    ```shell
    cd workshop
    yarn sb init --builder @storybook/builder-vite
    ```
  </Tab>
  <Tab>
      If you're using `pnpm`, you'll need to add a file at the root of your monorepo called `.npmrc` before you install Storybook:
      ```txt filename=".npmrc"
      auto-install-peers=true
      node-linker=hoisted
      ```
      ```shell
      cd workshop
      {/* pnpm init */}
      {/* pnpm i svelte              # To make SB recognize the package as a svelte project */}
      pnpx sb init -s            # Only setup files
      pnpm i                     # Manually install
      pnpm i -D @storybook/cli   # Needed for start-storybook command
      ```
  </Tab>
</Tabs>

### 3. Set up a story for our Button

The Storybook scaffold creates some stories and components in the `/src/stories` directory but we only need the `Button.stories.tsx` file. You can delete all of the other files in `/src/stories` and then head to your `ui` package to update your button so that it works for the story's expectations.

1. Update your button.

```jsx filename="packages/ui/Button.tsx"
interface Props {
  primary?: boolean
  label?: string
}


export const Button = ({ primary = false, label = "Boop" }: Props) => {
  return (
    <button
     style={{ backgroundColor: primary ? "red" : "blue" }}>
      {label}
    </button>
  );
};

```

2. Install it in the `workshop` app:

```json filename="apps/workshop/package.json"
{
  // ...
  {
    "dependencies": {
      "ui": "workspace:*",
      // ...
    }
  }
}
```

3. Replace the `Button` import in the `Button.stories.tsx` so that it comes from our `ui` package:

```jsx filename="apps/workshop/src/stories/Button.stories.tsx"
  import { Button } from 'ui'
```

### 3. Run your dev and build tasks

The last thing that we need to do is make sure that Storybook is lined up with the rest of our tasks. Let's update the scripts in your `workshop` app:

```json filename="/apps/workshop/package.json"
  {
    // ...
    "scripts": {
      "dev": "start-storybook -p 6006",
      "build": "build-storybook"
    }
  }
```

You can now develop your Storybook at the same time as your applications and enjoy parallel builds with the rest of your applications.
